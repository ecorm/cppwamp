<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CppWAMP: Variants</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CppWAMP
   </div>
   <div id="projectbrief">C++11 client library for the WAMP protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_variants_tutorial.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Variants </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#autotoc_md36">Construction and Assignment</a></li>
<li class="level2"><a href="#autotoc_md37">Checking Dynamic Type</a></li>
<li class="level2"><a href="#autotoc_md38">Accessing Values</a></li>
<li class="level2"><a href="#autotoc_md39">Accessing Elements and Members</a></li>
<li class="level2"><a href="#autotoc_md40">Binary Objects (BLOBs)</a></li>
<li class="level2"><a href="#autotoc_md41">Using Variants as Optional Values</a></li>
<li class="level2"><a href="#autotoc_md42">Conversions</a></li>
<li class="level2"><a href="#autotoc_md43">Comparisons</a></li>
<li class="level2"><a href="#autotoc_md44">Output</a></li>
</ul>
</ul>
</div>
<div class="textblock"><p>A <a class="el" href="classwamp_1_1_variant.html" title="Discriminated union container that represents a JSON value.">wamp::Variant</a> is a discriminated union container that represents a JSON value. It behaves similarly to a dynamically-typed Javascript variable. Its underlying type can change at runtime, depending on the actual values assigned to them. <code>Variant</code>s play a central role in CppWAMP, as they are used to represent dynamic data exchanged with a WAMP peer.</p>
<p><code>Variant</code>s can hold any of the following value types:</p><ul>
<li><a class="el" href="structwamp_1_1_null.html" title="Type used to represent a null or empty Variant value.">wamp::Null</a> : represents an empty or missing value</li>
<li><a class="el" href="namespacewamp.html#af47b8d725f6e4e5b20477ed7b1e2cc12" title="Variant bound type for boolean values.">wamp::Bool</a> : true or false</li>
<li><a class="el" href="namespacewamp.html#afafe0c1169d7725af2c3a5b3b8f5bb67" title="Variant bound type for signed integers.">wamp::Int</a> : signed integer (64-bit)</li>
<li><a class="el" href="namespacewamp.html#ad6171f0b875d7e5b8622bfb2a0ef213c" title="Variant bound type for unsigned integers.">wamp::UInt</a>: unsigned integer (64-bit)</li>
<li><a class="el" href="namespacewamp.html#a5558fb9fd53749b33e654e540ec1e65e" title="Variant bound type for floating-point numbers.">wamp::Real</a>: floating point number (double precision)</li>
<li><a class="el" href="namespacewamp.html#a0b58ab2a2761bca711bc957b47619662" title="Variant bound type for text strings.">wamp::String</a> : only UTF-8 encoded strings are currently supported</li>
<li><a class="el" href="classwamp_1_1_blob.html" title="Contains binary data as an array of bytes.">wamp::Blob</a> : A binary object represented as an array of bytes</li>
<li><a class="el" href="namespacewamp.html#a2daa037ae4c3853086e789bad1978ca2" title="Variant bound type for arrays of variants.">wamp::Array</a> : dynamically-sized lists of variants</li>
<li><a class="el" href="namespacewamp.html#a2027fe57e4014c013dcbbc733a1c9a56" title="Variant bound type for maps of variants.">wamp::Object</a> : dictionaries having string keys and variant values</li>
</ul>
<p><code>Array</code> and <code>Object</code> variants are recursive composites: their element values are also variants which can themselves be arrays or objects.</p>
<h2><a class="anchor" id="autotoc_md36"></a>
Construction and Assignment</h2>
<p>A default-constructed <code>Variant</code> starts out being null: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="variant_8hpp.html">cppwamp/variant.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v; <span class="comment">// v starts out being null</span></div>
</div><!-- fragment --><p>A <code>Variant</code> can also be constructed with an initial value: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v(42); <span class="comment">// v starts out as an integer</span></div>
</div><!-- fragment --><p>The dynamic type of a <code>Variant</code> can change at runtime via assignment: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;    <span class="comment">// v starts out being null</span></div>
<div class="line">v = 42;       <span class="comment">// v becomes an integer</span></div>
<div class="line">v = <span class="stringliteral">&quot;hello&quot;</span>;  <span class="comment">// v becomes a string</span></div>
<div class="line">v = <span class="keyword">null</span>;     <span class="comment">// v becomes nullified</span></div>
<div class="line">v = <a class="code" href="namespacewamp.html#a2daa037ae4c3853086e789bad1978ca2">Array</a>{123, <span class="keyword">false</span>, <span class="stringliteral">&quot;foo&quot;</span>}; <span class="comment">// v becomes an array of variants</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md37"></a>
Checking Dynamic Type</h2>
<p>Each <code>Variant</code> stores its current dynamic type as a <a class="el" href="namespacewamp.html#a4d04d75506649324abb78e785749ccdb" title="Integer ID used to indicate the current dynamic type of a Variant.">wamp::TypeId</a> enumerator. The dynamic type can be checked with <a class="el" href="classwamp_1_1_variant.html#adabda0653a0d5c09a9347f0506ae2b9f" title="Returns the id of the variant&#39;s current dynamic type.">wamp::Variant::typeId()</a> or <a class="el" href="classwamp_1_1_variant.html#a598427ddf75fa40069254a085c2b01b3" title="Returns true iff the variant&#39;s current dynamic type matches the given TBound type parameter.">wamp::Variant::is&lt;T&gt;()</a>. In addition, <code>operator bool</code> can be used to determine if a variant is null.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;    <span class="comment">// v starts out being null</span></div>
<div class="line">assert( !v );   <span class="comment">// Check that the variant is indeed null</span></div>
<div class="line">assert( v == <span class="keyword">null</span> );</div>
<div class="line">assert( v.<a class="code" href="classwamp_1_1_variant.html#adabda0653a0d5c09a9347f0506ae2b9f">typeId</a>() == <a class="code" href="namespacewamp.html#a4d04d75506649324abb78e785749ccdba37a6259cc0c1dae299a7866489dff0bd">TypeId::null</a> );</div>
<div class="line">assert( v.<a class="code" href="classwamp_1_1_variant.html#a598427ddf75fa40069254a085c2b01b3">is</a>&lt;<a class="code" href="structwamp_1_1_null.html">Null</a>&gt;() );</div>
<div class="line">assert( v.<a class="code" href="classwamp_1_1_variant.html#a598427ddf75fa40069254a085c2b01b3">is</a>&lt;<a class="code" href="namespacewamp.html#a4d04d75506649324abb78e785749ccdba37a6259cc0c1dae299a7866489dff0bd">TypeId::null</a>&gt;() );</div>
<div class="line"> </div>
<div class="line">v = 42;       <span class="comment">// v becomes an integer</span></div>
<div class="line">assert( !!v); <span class="comment">// Check that the variant is no longer null</span></div>
<div class="line">assert( v != <span class="keyword">null</span> );</div>
<div class="line">assert( v.<a class="code" href="classwamp_1_1_variant.html#adabda0653a0d5c09a9347f0506ae2b9f">typeId</a>() == <a class="code" href="namespacewamp.html#a4d04d75506649324abb78e785749ccdba157db7df530023575515d366c9b672e8">TypeId::integer</a> );</div>
<div class="line">assert( v.<a class="code" href="classwamp_1_1_variant.html#a598427ddf75fa40069254a085c2b01b3">is</a>&lt;<a class="code" href="namespacewamp.html#afafe0c1169d7725af2c3a5b3b8f5bb67">Int</a>&gt;() );</div>
<div class="line">assert( v.<a class="code" href="classwamp_1_1_variant.html#a598427ddf75fa40069254a085c2b01b3">is</a>&lt;<a class="code" href="namespacewamp.html#a4d04d75506649324abb78e785749ccdba157db7df530023575515d366c9b672e8">TypeId::integer</a>&gt;() );</div>
</div><!-- fragment --><p>The <a class="el" href="classwamp_1_1_variant.html#a75676feccd7b98a16059410737f29fb0">isNumber</a> non-member function can be used to check if a <code>Variant</code> is currently a number (<code>Int</code>, <code>UInt</code>, or <code>Real</code>). The <a class="el" href="classwamp_1_1_variant.html#ab1e5fc1e9d53ea3d670327696cde0d2e">isScalar</a> non-member function checks if a variant is a boolean or a number: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v(<span class="stringliteral">&quot;hello&quot;</span>); <span class="comment">// v starts out as a string</span></div>
<div class="line">assert( !<a class="code" href="namespacewamp.html#a0f60ee29904aa30973713672aa3fc37b">isNumber</a>(v) );</div>
<div class="line">assert( !isScalar(v) );</div>
<div class="line"> </div>
<div class="line">v = <span class="keyword">true</span>; <span class="comment">// v is now a boolean</span></div>
<div class="line">assert ( !<a class="code" href="namespacewamp.html#a0f60ee29904aa30973713672aa3fc37b">isNumber</a>(v) );</div>
<div class="line">assert ( isScalar(v) );</div>
<div class="line"> </div>
<div class="line">v = 123.4; <span class="comment">// v is now a real number</span></div>
<div class="line">assert ( <a class="code" href="namespacewamp.html#a0f60ee29904aa30973713672aa3fc37b">isNumber</a>(v) );</div>
<div class="line">assert ( isScalar(v) );</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md38"></a>
Accessing Values</h2>
<p>Variant values can be accessed directly using <a class="el" href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">Variant::as&lt;T&gt;()</a>. If the variant does not match the target type, a <a class="el" href="structwamp_1_1error_1_1_access.html" title="Exception type thrown when accessing a Variant as an invalid type.">wamp::error::Access</a> exception is thrown. </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v(42); <span class="comment">// v starts out as an Int</span></div>
<div class="line">std::cout &lt;&lt; v.<a class="code" href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">as</a>&lt;<a class="code" href="namespacewamp.html#afafe0c1169d7725af2c3a5b3b8f5bb67">Int</a>&gt;() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints 42</span></div>
<div class="line">v.<a class="code" href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">as</a>&lt;<a class="code" href="namespacewamp.html#afafe0c1169d7725af2c3a5b3b8f5bb67">Int</a>&gt;() += 10;</div>
<div class="line">std::cout &lt;&lt; v.<a class="code" href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">as</a>&lt;<a class="code" href="namespacewamp.html#afafe0c1169d7725af2c3a5b3b8f5bb67">Int</a>&gt;() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints 52</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    std::cout &lt;&lt; v.<a class="code" href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">as</a>&lt;<a class="code" href="namespacewamp.html#a0b58ab2a2761bca711bc957b47619662">String</a>&gt;() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// throws</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="structwamp_1_1error_1_1_access.html">error::Access</a>&amp; e)</div>
<div class="line">{</div>
<div class="line">    std::cerr &lt;&lt; e.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md39"></a>
Accessing Elements and Members</h2>
<p>For convenience, elements can be accessed directly from array variants, using the <a class="el" href="classwamp_1_1_variant.html#a52c83ebc4ce202e56b97b9ae9a5ae91b">[] operator</a> taking an integer index: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;</div>
<div class="line"><span class="comment">// v[0] = 42;                  // throws error::Access, because v does not</span></div>
<div class="line">                               <span class="comment">//     contain an Array</span></div>
<div class="line">v = <a class="code" href="namespacewamp.html#a2daa037ae4c3853086e789bad1978ca2">Array</a>{42, <span class="stringliteral">&quot;foo&quot;</span>, <span class="keyword">false</span>};   <span class="comment">// v now contains an Array</span></div>
<div class="line">std::cout &lt;&lt; v.<a class="code" href="classwamp_1_1_variant.html#aef9bede0c5b40adc5f393a664fe12430">size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints 3</span></div>
<div class="line">std::cout &lt;&lt; v[1] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;     <span class="comment">// Prints &quot;foo&quot;</span></div>
<div class="line">v[2] = <span class="stringliteral">&quot;bar&quot;</span>;                  <span class="comment">// Assigns string &quot;bar&quot; to third element</span></div>
<div class="line">std::cout &lt;&lt; v[2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;     <span class="comment">// Prints &quot;bar&quot;</span></div>
<div class="line">std::cout &lt;&lt; v[3] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;     <span class="comment">// throws std::out_of_range</span></div>
</div><!-- fragment --><p>For convenience, members can be accessed directly from object variants, using the <a class="el" href="classwamp_1_1_variant.html#a1ba405c49c7f0dd966f66e26e7c6f38c">[] operator</a> taking a string key: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;</div>
<div class="line"><span class="comment">// v[&quot;key&quot;] = 123;             // throws error::Access, because v does not</span></div>
<div class="line">                               <span class="comment">//     contain an Object</span></div>
<div class="line">v = <a class="code" href="namespacewamp.html#a2027fe57e4014c013dcbbc733a1c9a56">Object</a>{{<span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;value&quot;</span>}};  <span class="comment">// v now contains an Object</span></div>
<div class="line">std::cout &lt;&lt; v.<a class="code" href="classwamp_1_1_variant.html#aef9bede0c5b40adc5f393a664fe12430">size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints 1</span></div>
<div class="line">v[<span class="stringliteral">&quot;key&quot;</span>] = 123;                <span class="comment">// Assigns integer 123 to member &quot;key&quot;</span></div>
<div class="line">std::cout &lt;&lt; v[<span class="stringliteral">&quot;key&quot;</span>] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints 123</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
Binary Objects (BLOBs)</h2>
<p><code>Variant</code>s may also contain arbitrary binary objects. Such binary objects must be stored in <a class="el" href="classwamp_1_1_blob.html" title="Contains binary data as an array of bytes.">wamp::Blob</a>, which is simply a wrapper around <code>std::vector&lt;uint8_t&gt;</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;</div>
<div class="line">v = <a class="code" href="classwamp_1_1_blob.html">Blob</a>{0x12, 0x34, 0x56}; <span class="comment">// Assign a binary object of 3 bytes</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">byte</span>: v.<a class="code" href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">as</a>&lt;<a class="code" href="classwamp_1_1_blob.html">Blob</a>&gt;().<a class="code" href="classwamp_1_1_blob.html#a6ababeea33598b36054d660c220395a1">data</a>()) <span class="comment">// Access byte data vector</span></div>
<div class="line">    std::cout &lt;&lt; <span class="keywordtype">byte</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
</div><!-- fragment --><p>When transmitted using JSON serialization, <code>Blob</code>s are encoded as Base64 strings prefixed with a nul character. For MsgPack, they are encoded in <code>bin</code> format.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Using Variants as Optional Values</h2>
<p>Because variants can be null, they can be used to contain optional (i.e. nullable) values. The boolean conversion operator is useful for knowing if a variant is currently null: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v = 123;</div>
<div class="line"><span class="keywordflow">if</span> (!v) <span class="comment">// Evaluates to false</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The value is empty\n&quot;</span>;</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The value is &quot;</span> &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints 123</span></div>
</div><!-- fragment --><p>The <a class="el" href="classwamp_1_1_variant.html#ae03fdb9a45b4f116923cdcadcb2ed3a7">valueOr</a> member function can be used to obtain a fallback value if a variant is null: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> name; <span class="comment">// name is currently null</span></div>
<div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;Name is &quot;</span></div>
<div class="line">          &lt;&lt; name.<a class="code" href="classwamp_1_1_variant.html#ae03fdb9a45b4f116923cdcadcb2ed3a7">valueOr</a>&lt;std::string&gt;(<span class="stringliteral">&quot;anonymous&quot;</span>) <span class="comment">// Prints &quot;anonymous&quot;</span></div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md42"></a>
Conversions</h2>
<p>Sometimes, it's not possible to know what numeric type to expect from a WAMP peer. <a class="el" href="classwamp_1_1_variant.html#ac59c2a98e2df7cb38ba7b13e2085ac9c" title="Converts the variant&#39;s bound value to the given type.">wamp::Variant::to</a> lets you convert from any scalar type to a known destination type. </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;</div>
<div class="line"><a class="code" href="namespacewamp.html#a5558fb9fd53749b33e654e540ec1e65e">Real</a> x;</div>
<div class="line"> </div>
<div class="line">v = 42; <span class="comment">// v is now an integer</span></div>
<div class="line">x = v.<a class="code" href="classwamp_1_1_variant.html#ac59c2a98e2df7cb38ba7b13e2085ac9c">to</a>&lt;<a class="code" href="namespacewamp.html#a5558fb9fd53749b33e654e540ec1e65e">Real</a>&gt;();</div>
<div class="line">assert( x == 42 );</div>
<div class="line"> </div>
<div class="line">v = <span class="keyword">true</span>; <span class="comment">// v is now a boolean</span></div>
<div class="line">v.<a class="code" href="classwamp_1_1_variant.html#ac59c2a98e2df7cb38ba7b13e2085ac9c">to</a>(x);  <span class="comment">// Alternate syntax, equivalent to x = v.to&lt;Real&gt;()</span></div>
<div class="line">assert( x == 1 );</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespacewamp.html#a0b58ab2a2761bca711bc957b47619662">String</a> s;</div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    s = v.<a class="code" href="classwamp_1_1_variant.html#ac59c2a98e2df7cb38ba7b13e2085ac9c">to</a>&lt;<a class="code" href="namespacewamp.html#a0b58ab2a2761bca711bc957b47619662">String</a>&gt;(); <span class="comment">// Invalid conversion from boolean to string</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="structwamp_1_1error_1_1_conversion.html">error::Conversion</a>&amp; e)</div>
<div class="line">{</div>
<div class="line">    std::cerr &lt;&lt; e.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md43"></a>
Comparisons</h2>
<p><code>Variant</code> objects can be compared with each other, or with other values. For the comparison to be equal, both types must match. However, all numeric types are considered to be the same type for comparison purposes (this is to more closely match the behavior of the <code>===</code> operator in Javascript, where it does not distinguish between signed/unsigned or integer/floating-point numbers). </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v; <span class="comment">// Starts as null</span></div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> w; <span class="comment">// Starts as null</span></div>
<div class="line">assert( v == w ); <span class="comment">// null == null is always true</span></div>
<div class="line"> </div>
<div class="line">v = 42;   <span class="comment">// v is now an integer</span></div>
<div class="line">w = <span class="stringliteral">&quot;42&quot;</span>; <span class="comment">// w is now a string</span></div>
<div class="line">assert( v != w ); <span class="comment">// Types do not match</span></div>
<div class="line"> </div>
<div class="line">v = 123;   <span class="comment">// v is still an integer</span></div>
<div class="line">w = 123.0; <span class="comment">// w is now a real number</span></div>
<div class="line">assert( v == w ); <span class="comment">// Numeric types match for comparison purposes</span></div>
<div class="line"> </div>
<div class="line">v = 0;     <span class="comment">// v is still an integer</span></div>
<div class="line">w = <span class="keyword">false</span>; <span class="comment">// w is now a boolean</span></div>
<div class="line">assert( v != w ); <span class="comment">// Types do not match</span></div>
<div class="line"> </div>
<div class="line">v = <span class="stringliteral">&quot;hello&quot;</span>; <span class="comment">// v is now a String</span></div>
<div class="line"><span class="comment">// String variants can be compared against `char` arrays:</span></div>
<div class="line">assert( v == <span class="stringliteral">&quot;hello&quot;</span> );</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md44"></a>
Output</h2>
<p><a class="el" href="classwamp_1_1_variant.html" title="Discriminated union container that represents a JSON value.">wamp::Variant</a>, <a class="el" href="namespacewamp.html#a2daa037ae4c3853086e789bad1978ca2" title="Variant bound type for arrays of variants.">wamp::Array</a>, and <a class="el" href="namespacewamp.html#a2027fe57e4014c013dcbbc733a1c9a56" title="Variant bound type for maps of variants.">wamp::Object</a> objects can be outputted to a <code>std::ostream</code>: </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="classwamp_1_1_variant.html">Variant</a> v;</div>
<div class="line">std::cout &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints &quot;null&quot;</span></div>
<div class="line">v = 42;</div>
<div class="line">std::cout &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints &quot;42&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespacewamp.html#a2daa037ae4c3853086e789bad1978ca2">Array</a> a{<span class="stringliteral">&quot;foo&quot;</span>, <span class="keyword">false</span>, 123};</div>
<div class="line">v = a;</div>
<div class="line">std::cout &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints &quot;[&quot;foo&quot;, false, 123]&quot;</span></div>
<div class="line">std::cout &lt;&lt; v &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>; <span class="comment">// Prints &quot;[&quot;foo&quot;, false, 123]&quot;</span></div>
</div><!-- fragment --><hr  />
<p>Next: <a class="el" href="_connectors_tutorial.html">Connectors</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclasswamp_1_1_variant_html_adabda0653a0d5c09a9347f0506ae2b9f"><div class="ttname"><a href="classwamp_1_1_variant.html#adabda0653a0d5c09a9347f0506ae2b9f">wamp::Variant::typeId</a></div><div class="ttdeci">TypeId typeId() const</div><div class="ttdoc">Returns the id of the variant's current dynamic type.</div><div class="ttdef"><b>Definition:</b> variant.ipp:242</div></div>
<div class="ttc" id="aclasswamp_1_1_blob_html"><div class="ttname"><a href="classwamp_1_1_blob.html">wamp::Blob</a></div><div class="ttdoc">Contains binary data as an array of bytes.</div><div class="ttdef"><b>Definition:</b> blob.hpp:29</div></div>
<div class="ttc" id="astructwamp_1_1_null_html"><div class="ttname"><a href="structwamp_1_1_null.html">wamp::Null</a></div><div class="ttdoc">Type used to represent a null or empty Variant value.</div><div class="ttdef"><b>Definition:</b> null.hpp:39</div></div>
<div class="ttc" id="aclasswamp_1_1_variant_html"><div class="ttname"><a href="classwamp_1_1_variant.html">wamp::Variant</a></div><div class="ttdoc">Discriminated union container that represents a JSON value.</div><div class="ttdef"><b>Definition:</b> variant.hpp:135</div></div>
<div class="ttc" id="aclasswamp_1_1_variant_html_aef9bede0c5b40adc5f393a664fe12430"><div class="ttname"><a href="classwamp_1_1_variant.html#aef9bede0c5b40adc5f393a664fe12430">wamp::Variant::size</a></div><div class="ttdeci">SizeType size() const</div><div class="ttdoc">Returns the number of elements contained by the variant.</div><div class="ttdef"><b>Definition:</b> variant.ipp:254</div></div>
<div class="ttc" id="anamespacewamp_html_a2027fe57e4014c013dcbbc733a1c9a56"><div class="ttname"><a href="namespacewamp.html#a2027fe57e4014c013dcbbc733a1c9a56">wamp::Object</a></div><div class="ttdeci">std::map&lt; String, Variant &gt; Object</div><div class="ttdoc">Variant bound type for maps of variants.</div><div class="ttdef"><b>Definition:</b> variantdefs.hpp:53</div></div>
<div class="ttc" id="anamespacewamp_html"><div class="ttname"><a href="namespacewamp.html">wamp</a></div><div class="ttdef"><b>Definition:</b> asiodefs.hpp:22</div></div>
<div class="ttc" id="anamespacewamp_html_a2daa037ae4c3853086e789bad1978ca2"><div class="ttname"><a href="namespacewamp.html#a2daa037ae4c3853086e789bad1978ca2">wamp::Array</a></div><div class="ttdeci">std::vector&lt; Variant &gt; Array</div><div class="ttdoc">Variant bound type for arrays of variants.</div><div class="ttdef"><b>Definition:</b> variantdefs.hpp:52</div></div>
<div class="ttc" id="anamespacewamp_html_afafe0c1169d7725af2c3a5b3b8f5bb67"><div class="ttname"><a href="namespacewamp.html#afafe0c1169d7725af2c3a5b3b8f5bb67">wamp::Int</a></div><div class="ttdeci">std::int64_t Int</div><div class="ttdoc">Variant bound type for signed integers.</div><div class="ttdef"><b>Definition:</b> variantdefs.hpp:48</div></div>
<div class="ttc" id="aclasswamp_1_1_blob_html_a6ababeea33598b36054d660c220395a1"><div class="ttname"><a href="classwamp_1_1_blob.html#a6ababeea33598b36054d660c220395a1">wamp::Blob::data</a></div><div class="ttdeci">Data &amp; data()</div><div class="ttdoc">Obtains the blob's array of bytes.</div><div class="ttdef"><b>Definition:</b> blob.ipp:25</div></div>
<div class="ttc" id="anamespacewamp_html_a5558fb9fd53749b33e654e540ec1e65e"><div class="ttname"><a href="namespacewamp.html#a5558fb9fd53749b33e654e540ec1e65e">wamp::Real</a></div><div class="ttdeci">double Real</div><div class="ttdoc">Variant bound type for floating-point numbers.</div><div class="ttdef"><b>Definition:</b> variantdefs.hpp:50</div></div>
<div class="ttc" id="aclasswamp_1_1_variant_html_a598427ddf75fa40069254a085c2b01b3"><div class="ttname"><a href="classwamp_1_1_variant.html#a598427ddf75fa40069254a085c2b01b3">wamp::Variant::is</a></div><div class="ttdeci">bool is() const</div><div class="ttdoc">Returns true iff the variant's current dynamic type matches the given TBound type parameter.</div><div class="ttdef"><b>Definition:</b> variant.hpp:790</div></div>
<div class="ttc" id="aclasswamp_1_1_variant_html_ae03fdb9a45b4f116923cdcadcb2ed3a7"><div class="ttname"><a href="classwamp_1_1_variant.html#ae03fdb9a45b4f116923cdcadcb2ed3a7">wamp::Variant::valueOr</a></div><div class="ttdeci">ValueTypeOf&lt; T &gt; valueOr(T &amp;&amp;fallback) const</div><div class="ttdoc">Obtains the variant's value converted to the given type, or the given fallback value if the variant i...</div><div class="ttdef"><b>Definition:</b> variant.hpp:857</div></div>
<div class="ttc" id="aclasswamp_1_1_variant_html_a1315ba0cee052b30fdb6fd81aba431d9"><div class="ttname"><a href="classwamp_1_1_variant.html#a1315ba0cee052b30fdb6fd81aba431d9">wamp::Variant::as</a></div><div class="ttdeci">TBound &amp; as()</div><div class="ttdoc">Returns a reference to the variant's bound value.</div><div class="ttdef"><b>Definition:</b> variant.hpp:871</div></div>
<div class="ttc" id="avariant_8hpp_html"><div class="ttname"><a href="variant_8hpp.html">variant.hpp</a></div><div class="ttdoc">Contains the declaration of Variant and other closely related types/functions.</div></div>
<div class="ttc" id="astructwamp_1_1error_1_1_conversion_html"><div class="ttname"><a href="structwamp_1_1error_1_1_conversion.html">wamp::error::Conversion</a></div><div class="ttdoc">Exception type thrown when converting a Variant to an invalid type.</div><div class="ttdef"><b>Definition:</b> error.hpp:105</div></div>
<div class="ttc" id="aclasswamp_1_1_variant_html_ac59c2a98e2df7cb38ba7b13e2085ac9c"><div class="ttname"><a href="classwamp_1_1_variant.html#ac59c2a98e2df7cb38ba7b13e2085ac9c">wamp::Variant::to</a></div><div class="ttdeci">T to() const</div><div class="ttdoc">Converts the variant's bound value to the given type.</div><div class="ttdef"><b>Definition:</b> variant.hpp:832</div></div>
<div class="ttc" id="anamespacewamp_html_a4d04d75506649324abb78e785749ccdba37a6259cc0c1dae299a7866489dff0bd"><div class="ttname"><a href="namespacewamp.html#a4d04d75506649324abb78e785749ccdba37a6259cc0c1dae299a7866489dff0bd">wamp::TypeId::null</a></div><div class="ttdeci">@ null</div><div class="ttdoc">For Variant::Null.</div></div>
<div class="ttc" id="anamespacewamp_html_a0b58ab2a2761bca711bc957b47619662"><div class="ttname"><a href="namespacewamp.html#a0b58ab2a2761bca711bc957b47619662">wamp::String</a></div><div class="ttdeci">std::string String</div><div class="ttdoc">Variant bound type for text strings.</div><div class="ttdef"><b>Definition:</b> variantdefs.hpp:51</div></div>
<div class="ttc" id="anamespacewamp_html_a0f60ee29904aa30973713672aa3fc37b"><div class="ttname"><a href="namespacewamp.html#a0f60ee29904aa30973713672aa3fc37b">wamp::isNumber</a></div><div class="ttdeci">constexpr bool isNumber()</div><div class="ttdoc">Determines if the given type is considered a number.</div><div class="ttdef"><b>Definition:</b> traits.hpp:78</div></div>
<div class="ttc" id="astructwamp_1_1error_1_1_access_html"><div class="ttname"><a href="structwamp_1_1error_1_1_access.html">wamp::error::Access</a></div><div class="ttdoc">Exception type thrown when accessing a Variant as an invalid type.</div><div class="ttdef"><b>Definition:</b> error.hpp:97</div></div>
<div class="ttc" id="anamespacewamp_html_a4d04d75506649324abb78e785749ccdba157db7df530023575515d366c9b672e8"><div class="ttname"><a href="namespacewamp.html#a4d04d75506649324abb78e785749ccdba157db7df530023575515d366c9b672e8">wamp::TypeId::integer</a></div><div class="ttdeci">@ integer</div><div class="ttdoc">For Variant::Int.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_tutorial.html">Tutorial</a></li>
    <li class="footer">Generated on Tue Jun 14 2022 20:12:24 for CppWAMP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
