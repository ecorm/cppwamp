<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CppWAMP: Error Handling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CppWAMP
   </div>
   <div id="projectbrief">C++11 client library for the WAMP protocol</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_errors_tutorial.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Error Handling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><ul><li class="level2"><a href="#autotoc_md16">ErrorOr and Exceptions</a></li>
<li class="level2"><a href="#autotoc_md17">Error Codes</a></li>
<li class="level2"><a href="#autotoc_md18">Failed Preconditions</a></li>
</ul>
</ul>
</div>
<div class="textblock"><p>This page describes how error handling is done via <code>ErrorOr</code>.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
ErrorOr and Exceptions</h2>
<p>Whenever an asynchronous <a class="el" href="classwamp_1_1_session.html" title="Session API used by a client peer in WAMP applications.">wamp::Session</a> operation fails, it will emit a <a class="el" href="classwamp_1_1_error_or.html" title="Minimalistic implementation of std::expected&lt;T, std::error_code&gt;">wamp::ErrorOr</a> that contains a <a href="http://en.cppreference.com/w/cpp/error/error_code"><code>std::error_code</code></a> instead of an actual result.</p>
<p>The <a class="el" href="classwamp_1_1_error_or.html#a2ea115a06219fae796639c454dfdd19a" title="Checked access of the stored value.">wamp::ErrorOr::value</a> method would normally be used to retrieve the underlying result of the asynchronous operation. If the <code>ErrorOr</code> instead contains an error, <code>ErrorOr::value</code> will throw a <a class="el" href="classwamp_1_1error_1_1_failure.html" title="General purpose runtime exception that wraps a std::error_code.">wamp::error::Failure</a> exception. Since <code>Failure</code> derives from <a href="http://en.cppreference.com/w/cpp/error/system_error"><code>std::system_error</code></a>, it contains a <code>std::error_code</code> that represents the cause of the error.</p>
<p>Example using error codes:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="namespacewamp.html#a9dd954da85bf9033739185b3a29e3e85">AsioContext</a> ioctx;</div>
<div class="line"><span class="keyword">auto</span> tcp = TcpConnector::create&lt;Json&gt;(ioctx, {<span class="stringliteral">&quot;localhost&quot;</span>, 8001});</div>
<div class="line"> </div>
<div class="line">boost::asio::spawn(ioctx, [&amp;](boost::asio::yield_context yield)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> session = <a class="code" href="classwamp_1_1_session.html#ae9275cf2d482536ea1cbc60a72bfab9a">Session::create</a>(ioctx, tcp);</div>
<div class="line">    <span class="keyword">auto</span> index = session-&gt;connect(yield);</div>
<div class="line">    <span class="keywordflow">if</span> (!index)</div>
<div class="line">    {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Connect failed: &quot;</span> &lt;&lt; index.error() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> info = session-&gt;join(<a class="code" href="classwamp_1_1_realm.html">Realm</a>(<span class="stringliteral">&quot;somerealm&quot;</span>), yield);</div>
<div class="line">    <span class="keywordflow">if</span> (!info)</div>
<div class="line">    {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;Join failed: &quot;</span> &lt;&lt; info.error() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// etc.</span></div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">ioctx.run();</div>
</div><!-- fragment --><p>Example using exceptions:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacewamp.html">wamp</a>;</div>
<div class="line"><a class="code" href="namespacewamp.html#a9dd954da85bf9033739185b3a29e3e85">AsioContext</a> ioctx;</div>
<div class="line"><span class="keyword">auto</span> tcp = TcpConnector::create&lt;Json&gt;(ioctx, {<span class="stringliteral">&quot;localhost&quot;</span>, 8001});</div>
<div class="line"> </div>
<div class="line">boost::asio::spawn(ioctx, [&amp;](boost::asio::yield_context yield)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> session = <a class="code" href="classwamp_1_1_session.html#ae9275cf2d482536ea1cbc60a72bfab9a">Session::create</a>(ioctx, tcp);</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        session-&gt;connect(yield).value(); <span class="comment">// Note the .value()</span></div>
<div class="line">        session-&gt;join(<a class="code" href="classwamp_1_1_realm.html">Realm</a>(<span class="stringliteral">&quot;somerealm&quot;</span>), yield).value(); <span class="comment">// Note the .value()</span></div>
<div class="line">        <span class="comment">// etc.</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="classwamp_1_1error_1_1_failure.html">error::Failure</a>&amp; e)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Print a message describing the error</span></div>
<div class="line">        std::cerr &lt;&lt; e.what() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Obtain the std::error_code associated with the exception</span></div>
<div class="line">        <span class="keyword">auto</span> ec = e.code();</div>
<div class="line">        <span class="keywordflow">if</span> (ec == <a class="code" href="namespacewamp.html#a9ecf2a0b15a4d67bb0cd1928b4056d46a1f7f92026f85b91bf2c50b57390b12a6">SessionErrc::noSuchRealm</a>)</div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;The realm doesn&#39;t exist\n&quot;</span>;</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;Unexpected error: &quot;</span> &lt;&lt; ec &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">ioctx.run();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
Error Codes</h2>
<p>An error code can either belong to <a href="http://en.cppreference.com/w/cpp/error/generic_category"><code>std::generic_category</code></a>, or to one of the error categories defined by the library in <code>&lt;<a class="el" href="error_8hpp.html" title="Contains facilities for reporting and describing errors.">cppwamp/error.hpp</a>&gt;</code>:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Error category </th><th class="markdownTableHeadNone">Values </th><th class="markdownTableHeadNone">Used for reporting  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="classwamp_1_1_session_category.html" title="std::error_category used for reporting errors at the WAMP session layer.">wamp::SessionCategory</a></code> </td><td class="markdownTableBodyNone"><code><a class="el" href="namespacewamp.html#a9ecf2a0b15a4d67bb0cd1928b4056d46" title="Error code values used with the SessionCategory error category.">wamp::SessionErrc</a></code> </td><td class="markdownTableBodyNone">WAMP session errors  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="classwamp_1_1_protocol_category.html" title="std::error_category used for reporting protocol errors related to invalid WAMP messages.">wamp::ProtocolCategory</a></code> </td><td class="markdownTableBodyNone"><code><a class="el" href="namespacewamp.html#a19ce4bc9c1e5512cec6ba323c4d324d0" title="Error code values used with the ProtocolCategory error category.">wamp::ProtocolErrc</a></code> </td><td class="markdownTableBodyNone">invalid WAMP messages  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="classwamp_1_1_transport_category.html" title="std::error_category used for reporting errors at the transport layer.">wamp::TransportCategory</a></code> </td><td class="markdownTableBodyNone"><code><a class="el" href="namespacewamp.html#a7a09562b29d4b6e42e37be77ec31829a" title="Error code values used with the TransportCategory error category.">wamp::TransportErrc</a></code> </td><td class="markdownTableBodyNone">general transport layer errors  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="classwamp_1_1_rawsock_category.html" title="std::error_category used for reporting errors specific to raw socket transports.">wamp::RawsockCategory</a></code> </td><td class="markdownTableBodyNone"><code><a class="el" href="namespacewamp.html#aa0bf722cbe7ad04d49ad94b6ec440541" title="Error code values used with the RawsockCategory error category.">wamp::RawsockErrc</a></code> </td><td class="markdownTableBodyNone">raw socket transport errors  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a href="http://en.cppreference.com/w/cpp/error/generic_category"><code>std::generic_category</code></a> </td><td class="markdownTableBodyNone"><a href="https://en.cppreference.com/w/cpp/error/errc"><code>std::errc</code></a> </td><td class="markdownTableBodyNone">OS-level socket errors  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md18"></a>
Failed Preconditions</h2>
<p>Note that <code>Session</code> will always throw <a class="el" href="structwamp_1_1error_1_1_logic.html" title="Exception thrown when a pre-condition is not met.">wamp::error::Logic</a> exceptions whenever preconditions are not met. Preconditions for API functions are listed in this reference documentation.</p>
<hr  />
<p>Next: <a class="el" href="_rpc_tutorial.html">Remote Procedure Calls</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="aclasswamp_1_1_session_html_ae9275cf2d482536ea1cbc60a72bfab9a"><div class="ttname"><a href="classwamp_1_1_session.html#ae9275cf2d482536ea1cbc60a72bfab9a">wamp::Session::create</a></div><div class="ttdeci">static Ptr create(AnyIoExecutor exec, const Connector::Ptr &amp;connector)</div><div class="ttdoc">Creates a new Session instance.</div><div class="ttdef"><b>Definition:</b> session.ipp:22</div></div>
<div class="ttc" id="aclasswamp_1_1_realm_html"><div class="ttname"><a href="classwamp_1_1_realm.html">wamp::Realm</a></div><div class="ttdoc">Realm URI and other options contained within WAMP HELLO messages.</div><div class="ttdef"><b>Definition:</b> peerdata.hpp:59</div></div>
<div class="ttc" id="aclasswamp_1_1error_1_1_failure_html"><div class="ttname"><a href="classwamp_1_1error_1_1_failure.html">wamp::error::Failure</a></div><div class="ttdoc">General purpose runtime exception that wraps a std::error_code.</div><div class="ttdef"><b>Definition:</b> error.hpp:52</div></div>
<div class="ttc" id="anamespacewamp_html"><div class="ttname"><a href="namespacewamp.html">wamp</a></div><div class="ttdef"><b>Definition:</b> anyhandler.hpp:36</div></div>
<div class="ttc" id="anamespacewamp_html_a9ecf2a0b15a4d67bb0cd1928b4056d46a1f7f92026f85b91bf2c50b57390b12a6"><div class="ttname"><a href="namespacewamp.html#a9ecf2a0b15a4d67bb0cd1928b4056d46a1f7f92026f85b91bf2c50b57390b12a6">wamp::SessionErrc::noSuchRealm</a></div><div class="ttdeci">@ noSuchRealm</div><div class="ttdoc">Attempt to join non-existent realm.</div></div>
<div class="ttc" id="anamespacewamp_html_a9dd954da85bf9033739185b3a29e3e85"><div class="ttname"><a href="namespacewamp.html#a9dd954da85bf9033739185b3a29e3e85">wamp::AsioContext</a></div><div class="ttdeci">boost::asio::io_context AsioContext</div><div class="ttdoc">Queues and runs I/O completion handlers.</div><div class="ttdef"><b>Definition:</b> asiodefs.hpp:34</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="_tutorial.html">Tutorial</a></li>
    <li class="footer">Generated on Sat Aug 13 2022 20:54:39 for CppWAMP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
